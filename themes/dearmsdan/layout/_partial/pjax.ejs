<script type="text/javascript">

$(document).pjax('a[target!=_blank]', '.main', {fragment: '.main',timeout: 8000}); 
    	/* .main为刷新的id */
    $(document).on('pjax:send', function() {
		/* 预加载函数 */
		
<% if (theme.background.verification == 'img' ){ %>
	backg()
<% } %>
	
<% if (theme.background.verification == 'video' ){ %>
	$('.dearmsdan-bg').css('background','none');
<% } %>
		postcolor();
		links();
		tocs();
		pagegun();
	 	styleS();
});

/*
本pjax代码修改前请先备份 

*/




$(function(){
	
<% if (theme.background.verification == 'img' ){ %>
	backg()
<% } %>
	
<% if (theme.background.verification == 'video' ){ %>
	$('.dearmsdan-bg').css('background','none');
<% } %>
	links();
	tocs();
	pagegun();
	styleS();
});

$(document).on('pjax:complete', function() {
	
<% if (theme.background.verification == 'img' ){ %>
	backg()
<% } %>
	
<% if (theme.background.verification == 'video' ){ %>
	$('.dearmsdan-bg').css('background','none');
<% } %>
		postcolor();
		links();
		tocs();
	    copycodes();
		pagegun();
	 	styleS();
		/* 右侧布的高度，相当于左侧高度
		$(".main").css({ 
			height: $("#sidebar-nav").outerHeight()
		});*/
	
		/* 设置 post 样式*/
		$(".dearmsdan-post").css("animation","1s ease 0s 1 normal forwards running action_translateY");
	

   		/* pjax加载结束的回调函数 解决js无法定位的问题*/
});

$(document).on('ready pjax:end', function(event) {
	
	<% if (theme.background.verification == 'img' ){ %>
		backg()
	<% } %>
	
<% if (theme.background.verification == 'video' ){ %>
	$('.dearmsdan-bg').css('background','none');
<% } %>
	postcolor();
	links();
	tocs();
	copycodes();
	pagegun();
	styleS();
	
		/* 淡入，如果 移动设备宽度大于714这影响 移动端显示文章空白效果，修改会出问题 */
	  var windowWidth = $(window).width();
    if(windowWidth < 714){
		// 淡入
    }
    if(windowWidth >= 714){
        // do something
		$(".dearmsdan").delay(300).addClass("wrapShow");
    }
})
	

<% if (theme.background.verification == 'img' ){ %>
function backg(){
	$('.dearmsdan-bg').css('background','none');
}
<% } %>





	
function styleS(){
if ((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))) {
    // 底部背景色
	$('.main').css('background','aliceblue');
	$('.main').css('max-height','100%');
	

	/* 首页 排版 */
	$('.dearmsdan-bg').css('box-shadow','none');
	$('.dearmsdan-bg').css('-webkit-box-shadow','none');
//	$('.main-content').css('background-color','#ECECEE');
	$('.dearmsdan-post').css('background-color','rgba(255, 255, 255, 0.52)');
	$('.dearmsdan-post').css('padding','30px');
	$('.dearmsdan-post').css('margin-bottom','20px');
	$('.main-content').addClass('m-content');
	
	
	/* 文章内容页 排版 */
	$('.dearmsdan-bg div').removeClass('div_bg');
	$('.dearmsdan-bg div').addClass('divbg');
	$('#dearmsdanPost').addClass('dearmsdanPost');
	
	
	
	
}else{
	
}
	
}


		/* 外链保护http://link.zhd99.cn \http://link.dearmsdan.com */
function links(){
	
		 <% if (theme.linker.enable == true){ %>
	
	$("article a").not(".toc a,article h1 a,article h2 a,article h3 a,article h4 a,article h5 a,article h6 a,article .gallerys,.ui-artZoom-buttons a").attr("href",
																													function(){
		// 不是本站链接检测  article
		var str = this.href;
		var pattern = /<%= theme.linker.site %>/;
		var falg = pattern.test(str).toString().trim();
		
		var pattern2 = /<%= theme.linker.sitee %>/;
		var falg2 = pattern2.test(str).toString().trim();
		if('true' != falg && 'true' != falg2){
			return '<%= theme.linker.link %>' + '?target=' + str;
		   }
});
	
		<% } %>
}

	// 当前刷新目录产生
function pagegun(){
			$(".second").pageslide();
}

	// 目录 被点击
	
function tocs(){
	$('.second').on('click', function () {
		
		if (!$('body').hasClass('layout-fullwidth')) {
			$('body').addClass('layout-fullwidth');    // 初始出现

		} else {
			$('body').addClass('layout-fullwidth');    // 初始出现
			
		}
		
		if ($(window).innerWidth() < 1025) {
			if (!$('body').hasClass('offcanvas-active')) {
				$('body').removeClass('offcanvas-active');
			} else {
				$('body').removeClass('offcanvas-active');
			}
		}
		
		
	});
}




/*页面载入完成后，创建复制按钮*/
function copycodes(){
	
	/* 代码高度 判断 */
	
	 $("figure td pre").scroll(function(){
        $("figure td:nth-child(1) pre").scrollTop($(this).scrollTop()); // 纵向滚动条
        $("figure td:nth-child(2) pre").scrollLeft($(this).scrollLeft()); // 横向滚动条
    });
	
		!function (e, t, a) {
		  /* code */
		  var initCopyCode = function(){
			var copyHtml = '';
			copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
			copyHtml += '  <i class="fa fa-globe"></i><span>copy</span>';
			copyHtml += '</button>';
			  // 设置 放置位置↓
			$("figure td:nth-child(2) pre").before(copyHtml);
			  		//$("figure td:nth-child(2) pre").wrap("<div></div>");
			new ClipboardJS('.btn-copy', {
				target: function(trigger) {
					return trigger.nextElementSibling;
				}
			});
		  }
		  initCopyCode();
			
			
		}(window, document);
}
		
	/* .dearmsdan-post悬浮变色 */ 

function postcolor(){
	
$(".dearmsdan-post").mouseover(function(){
		
	// 随机 变化的淡入
var arr = ['<%= theme.dearmsdanPostColor.pc1 %>','<%= theme.dearmsdanPostColor.pc2 %>','<%= theme.dearmsdanPostColor.pc3 %>','<%= theme.dearmsdanPostColor.pc4 %>','<%= theme.dearmsdanPostColor.pc5 %>','<%= theme.dearmsdanPostColor.pc6 %>','<%= theme.dearmsdanPostColor.pc7 %>','<%= theme.dearmsdanPostColor.pc8 %>','<%= theme.dearmsdanPostColor.pc9 %>','<%= theme.dearmsdanPostColor.pc10 %>','<%= theme.dearmsdanPostColor.pc11 %>']; 
		
var index = Math.floor((Math.random()*arr.length)); 
		   
    $('.dearmsdan-post').addClass('post-color');
	// 预期不佳
	$('.post-color:hover').css("box-shadow",arr[index]);
		
});
	$(".dearmsdan-post").mouseleave(function(){
	// 移除
	$('.post-color').css("box-shadow",'none');
		
});
	
}



</script>